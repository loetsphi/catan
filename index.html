<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Catan 5-6 Player Map</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;700&family=Crimson+Pro:wght@400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Crimson Pro', serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 10px;
            color: #fff;
            overflow-x: hidden;
        }

        .header {
            text-align: center;
            margin-bottom: 15px;
            width: 100%;
        }

        .title {
            font-family: 'Cinzel', serif;
            font-size: 28px;
            font-weight: 700;
            letter-spacing: 2px;
            color: #f4e4c1;
            text-shadow: 0 4px 20px rgba(244, 228, 193, 0.3);
            margin-bottom: 5px;
        }

        .subtitle {
            font-size: 13px;
            color: #b8a67f;
            letter-spacing: 0.5px;
        }

        .controls-mobile {
            width: 100%;
            max-width: 500px;
            background: linear-gradient(135deg, rgba(30, 30, 50, 0.95) 0%, rgba(20, 20, 40, 0.95) 100%);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
        }

        .control-title {
            font-family: 'Cinzel', serif;
            font-size: 14px;
            font-weight: 700;
            color: #f4e4c1;
            margin-bottom: 12px;
            letter-spacing: 1px;
        }

        .control-row {
            display: flex;
            gap: 10px;
            margin-bottom: 8px;
        }

        .seed-input {
            flex: 1;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            font-family: 'Crimson Pro', serif;
        }

        .seed-input:focus {
            outline: none;
            border-color: #f4e4c1;
            background: rgba(255, 255, 255, 0.15);
        }

        .shuffle-btn {
            flex: 1;
            padding: 12px;
            background: linear-gradient(135deg, #f4e4c1 0%, #d4c4a1 100%);
            border: none;
            border-radius: 10px;
            color: #2c2c2c;
            font-size: 16px;
            font-weight: 700;
            font-family: 'Cinzel', serif;
            cursor: pointer;
            letter-spacing: 1px;
            touch-action: manipulation;
        }

        .shuffle-btn:active {
            transform: scale(0.98);
        }

        .hint-text {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 8px;
            text-align: center;
        }

        .board-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px 10px;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.5);
            margin-bottom: 15px;
        }

        .board-wrapper {
            width: 100%;
            overflow-x: auto;
            overflow-y: visible;
            -webkit-overflow-scrolling: touch;
            padding: 10px 0;
        }

        .board {
            position: relative;
            width: 420px;
            height: 400px;
            margin: 0 auto;
            transform-origin: center top;
        }

        .hex {
            position: absolute;
            width: 56px;
            height: 64px;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .hex:active:not(.water) {
            transform: scale(1.1);
            z-index: 100;
            filter: brightness(1.15);
        }

        .hex-inner {
            position: relative;
            width: 100%;
            height: 100%;
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 1.5px solid rgba(0, 0, 0, 0.3);
            box-shadow: 
                0 4px 12px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        .hex.wood .hex-inner { background: linear-gradient(135deg, #2d5016 0%, #4a7c2f 100%); }
        .hex.wheat .hex-inner { background: linear-gradient(135deg, #d4a760 0%, #f4d88f 100%); }
        .hex.sheep .hex-inner { background: linear-gradient(135deg, #87b987 0%, #b4e6b4 100%); }
        .hex.ore .hex-inner { background: linear-gradient(135deg, #5a5f66 0%, #8b9299 100%); }
        .hex.brick .hex-inner { background: linear-gradient(135deg, #b54b2f 0%, #d97555 100%); }
        .hex.desert .hex-inner { background: linear-gradient(135deg, #c19a6b 0%, #d4b896 100%); }
        .hex.water .hex-inner { 
            background: linear-gradient(135deg, #1a5f7a 0%, #2c8ca8 100%);
            border-color: rgba(26, 95, 122, 0.4);
        }

        .resource-label {
            font-size: 6px;
            font-weight: 600;
            letter-spacing: 0.8px;
            text-transform: uppercase;
            color: rgba(255, 255, 255, 0.95);
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
            margin-bottom: 2px;
        }

        .number-token {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #ffffff 0%, #f5f5f5 100%);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 2px 6px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            border: 1px solid #e0e0e0;
        }

        .number {
            font-family: 'Cinzel', serif;
            font-size: 11px;
            font-weight: 700;
            line-height: 1;
        }

        .number.red { color: #c62828; }
        .number.black { color: #2c2c2c; }

        .token-letter {
            font-size: 5px;
            color: #999;
            margin-top: 0px;
            font-weight: 400;
        }

        .pips {
            font-size: 3px;
            color: #666;
            letter-spacing: 0.3px;
            margin-top: 0px;
        }

        .harbor-token {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(245, 245, 245, 0.9) 100%);
            border: 1px solid rgba(0, 0, 0, 0.2);
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 7px;
            font-weight: 700;
            color: #2c2c2c;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
        }
        
        .harbor-icon {
            font-size: 10px;
            margin-bottom: 0px;
        }

        .legend-mobile {
            width: 100%;
            max-width: 500px;
            background: linear-gradient(135deg, rgba(30, 30, 50, 0.95) 0%, rgba(20, 20, 40, 0.95) 100%);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
        }

        .legend-title {
            font-family: 'Cinzel', serif;
            font-size: 14px;
            font-weight: 700;
            color: #f4e4c1;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }

        .legend-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            font-size: 12px;
        }

        .legend-item {
            color: rgba(255, 255, 255, 0.85);
        }

        @keyframes hexAppear {
            from {
                opacity: 0;
                transform: scale(0.85);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .hex {
            animation: hexAppear 0.4s ease-out backwards;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="title">CATAN</div>
        <div class="subtitle">5-6 Player ‚Ä¢ Mobile</div>
    </div>

    <div class="controls-mobile">
        <div class="control-title">üé≤ Randomize Board</div>
        <div class="control-row">
            <input type="text" class="seed-input" id="seedInput" placeholder="Seed (optional)">
            <button class="shuffle-btn" onclick="shuffleBoard()">Shuffle</button>
        </div>
        <div class="hint-text">Same seed = same layout</div>
    </div>

    <div class="board-container">
        <div class="board-wrapper">
            <div class="board">
                <!-- Water frame top -->
                <div class="hex water" style="left: 121px; top: 0px;"><div class="hex-inner"></div></div>
                <div class="hex water" style="left: 169px; top: 0px;">
                    <div class="hex-inner">
                        <div class="harbor-token"><div class="harbor-icon">‚öì</div>3:1</div>
                    </div>
                </div>
                <div class="hex water" style="left: 217px; top: 0px;"><div class="hex-inner"></div></div>
                <div class="hex water" style="left: 265px; top: 0px;">
                    <div class="hex-inner">
                        <div class="harbor-token"><div class="harbor-icon">üåæ</div>2:1</div>
                    </div>
                </div>

                <!-- LAND ROW 1: 3 hexes -->
                <div class="hex water" style="left: 97px; top: 42px;"><div class="hex-inner"></div></div>
                <div class="hex wood" style="left: 145px; top: 42px;">
                    <div class="hex-inner">
                        <div class="resource-label">Wood</div>
                        <div class="number-token"><div class="number black">5</div><div class="token-letter">A</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex sheep" style="left: 193px; top: 42px;">
                    <div class="hex-inner">
                        <div class="resource-label">Sheep</div>
                        <div class="number-token"><div class="number black">2</div><div class="token-letter">B</div><div class="pips">‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex wheat" style="left: 241px; top: 42px;">
                    <div class="hex-inner">
                        <div class="resource-label">Wheat</div>
                        <div class="number-token"><div class="number red">6</div><div class="token-letter">C</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex water" style="left: 289px; top: 42px;"><div class="hex-inner"></div></div>

                <!-- LAND ROW 2: 4 hexes -->
                <div class="hex water" style="left: 73px; top: 84px;">
                    <div class="hex-inner">
                        <div class="harbor-token"><div class="harbor-icon">üß±</div>2:1</div>
                    </div>
                </div>
                <div class="hex brick" style="left: 121px; top: 84px;">
                    <div class="hex-inner">
                        <div class="resource-label">Brick</div>
                        <div class="number-token"><div class="number black">3</div><div class="token-letter">D</div><div class="pips">‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex ore" style="left: 169px; top: 84px;">
                    <div class="hex-inner">
                        <div class="resource-label">Ore</div>
                        <div class="number-token"><div class="number black">3</div><div class="token-letter">E</div><div class="pips">‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex wood" style="left: 217px; top: 84px;">
                    <div class="hex-inner">
                        <div class="resource-label">Wood</div>
                        <div class="number-token"><div class="number black">4</div><div class="token-letter">F</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex wheat" style="left: 265px; top: 84px;">
                    <div class="hex-inner">
                        <div class="resource-label">Wheat</div>
                        <div class="number-token"><div class="number black">4</div><div class="token-letter">G</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex water" style="left: 313px; top: 84px;"><div class="hex-inner"></div></div>

                <!-- LAND ROW 3: 5 hexes -->
                <div class="hex water" style="left: 49px; top: 126px;"><div class="hex-inner"></div></div>
                <div class="hex sheep" style="left: 97px; top: 126px;">
                    <div class="hex-inner">
                        <div class="resource-label">Sheep</div>
                        <div class="number-token"><div class="number black">5</div><div class="token-letter">H</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex brick" style="left: 145px; top: 126px;">
                    <div class="hex-inner">
                        <div class="resource-label">Brick</div>
                        <div class="number-token"><div class="number red">6</div><div class="token-letter">I</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex ore" style="left: 193px; top: 126px;">
                    <div class="hex-inner">
                        <div class="resource-label">Ore</div>
                        <div class="number-token"><div class="number black">9</div><div class="token-letter">J</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex wood" style="left: 241px; top: 126px;">
                    <div class="hex-inner">
                        <div class="resource-label">Wood</div>
                        <div class="number-token"><div class="number red">8</div><div class="token-letter">K</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex wheat" style="left: 289px; top: 126px;">
                    <div class="hex-inner">
                        <div class="resource-label">Wheat</div>
                        <div class="number-token"><div class="number black">10</div><div class="token-letter">L</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex water" style="left: 337px; top: 126px;">
                    <div class="hex-inner">
                        <div class="harbor-token"><div class="harbor-icon">‚öì</div>3:1</div>
                    </div>
                </div>

                <!-- LAND ROW 4: 6 hexes -->
                <div class="hex water" style="left: 25px; top: 168px;"><div class="hex-inner"></div></div>
                <div class="hex desert" style="left: 73px; top: 168px;">
                    <div class="hex-inner">
                        <div class="resource-label">Desert</div>
                        <div class="number-token" style="background: transparent; border: none; box-shadow: none;">
                            <div style="font-size: 16px;">üèúÔ∏è</div>
                        </div>
                    </div>
                </div>
                <div class="hex sheep" style="left: 121px; top: 168px;">
                    <div class="hex-inner">
                        <div class="resource-label">Sheep</div>
                        <div class="number-token"><div class="number black">11</div><div class="token-letter">M</div><div class="pips">‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex wheat" style="left: 169px; top: 168px;">
                    <div class="hex-inner">
                        <div class="resource-label">Wheat</div>
                        <div class="number-token"><div class="number black">10</div><div class="token-letter">N</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex brick" style="left: 217px; top: 168px;">
                    <div class="hex-inner">
                        <div class="resource-label">Brick</div>
                        <div class="number-token"><div class="number black">3</div><div class="token-letter">O</div><div class="pips">‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex ore" style="left: 265px; top: 168px;">
                    <div class="hex-inner">
                        <div class="resource-label">Ore</div>
                        <div class="number-token"><div class="number black">11</div><div class="token-letter">P</div><div class="pips">‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex wood" style="left: 313px; top: 168px;">
                    <div class="hex-inner">
                        <div class="resource-label">Wood</div>
                        <div class="number-token"><div class="number black">12</div><div class="token-letter">Q</div><div class="pips">‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex water" style="left: 361px; top: 168px;"><div class="hex-inner"></div></div>

                <!-- LAND ROW 5: 5 hexes -->
                <div class="hex water" style="left: 49px; top: 210px;"><div class="hex-inner"></div></div>
                <div class="hex ore" style="left: 97px; top: 210px;">
                    <div class="hex-inner">
                        <div class="resource-label">Ore</div>
                        <div class="number-token"><div class="number black">9</div><div class="token-letter">R</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex sheep" style="left: 145px; top: 210px;">
                    <div class="hex-inner">
                        <div class="resource-label">Sheep</div>
                        <div class="number-token"><div class="number black">2</div><div class="token-letter">S</div><div class="pips">‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex brick" style="left: 193px; top: 210px;">
                    <div class="hex-inner">
                        <div class="resource-label">Brick</div>
                        <div class="number-token"><div class="number red">8</div><div class="token-letter">T</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex wheat" style="left: 241px; top: 210px;">
                    <div class="hex-inner">
                        <div class="resource-label">Wheat</div>
                        <div class="number-token"><div class="number black">4</div><div class="token-letter">U</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex wood" style="left: 289px; top: 210px;">
                    <div class="hex-inner">
                        <div class="resource-label">Wood</div>
                        <div class="number-token"><div class="number black">5</div><div class="token-letter">V</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex water" style="left: 337px; top: 210px;">
                    <div class="hex-inner">
                        <div class="harbor-token"><div class="harbor-icon">‚õ∞Ô∏è</div>2:1</div>
                    </div>
                </div>

                <!-- LAND ROW 6: 4 hexes -->
                <div class="hex water" style="left: 73px; top: 252px;">
                    <div class="hex-inner">
                        <div class="harbor-token"><div class="harbor-icon">üå≤</div>2:1</div>
                    </div>
                </div>
                <div class="hex ore" style="left: 121px; top: 252px;">
                    <div class="hex-inner">
                        <div class="resource-label">Ore</div>
                        <div class="number-token"><div class="number red">6</div><div class="token-letter">W</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex sheep" style="left: 169px; top: 252px;">
                    <div class="hex-inner">
                        <div class="resource-label">Sheep</div>
                        <div class="number-token"><div class="number black">10</div><div class="token-letter">X</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex wheat" style="left: 217px; top: 252px;">
                    <div class="hex-inner">
                        <div class="resource-label">Wheat</div>
                        <div class="number-token"><div class="number red">8</div><div class="token-letter">Y</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex wood" style="left: 265px; top: 252px;">
                    <div class="hex-inner">
                        <div class="resource-label">Wood</div>
                        <div class="number-token"><div class="number black">9</div><div class="token-letter">Za</div><div class="pips">‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex water" style="left: 313px; top: 252px;"><div class="hex-inner"></div></div>

                <!-- LAND ROW 7: 3 hexes -->
                <div class="hex water" style="left: 97px; top: 294px;"><div class="hex-inner"></div></div>
                <div class="hex brick" style="left: 145px; top: 294px;">
                    <div class="hex-inner">
                        <div class="resource-label">Brick</div>
                        <div class="number-token"><div class="number black">11</div><div class="token-letter">Zb</div><div class="pips">‚Ä¢‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex desert" style="left: 193px; top: 294px;">
                    <div class="hex-inner">
                        <div class="resource-label">Desert</div>
                        <div class="number-token" style="background: transparent; border: none; box-shadow: none;">
                            <div style="font-size: 16px;">üèúÔ∏è</div>
                        </div>
                    </div>
                </div>
                <div class="hex sheep" style="left: 241px; top: 294px;">
                    <div class="hex-inner">
                        <div class="resource-label">Sheep</div>
                        <div class="number-token"><div class="number black">12</div><div class="token-letter">Zc</div><div class="pips">‚Ä¢</div></div>
                    </div>
                </div>
                <div class="hex water" style="left: 289px; top: 294px;"><div class="hex-inner"></div></div>

                <!-- Water frame bottom -->
                <div class="hex water" style="left: 121px; top: 336px;"><div class="hex-inner"></div></div>
                <div class="hex water" style="left: 169px; top: 336px;">
                    <div class="hex-inner">
                        <div class="harbor-token"><div class="harbor-icon">üêë</div>2:1</div>
                    </div>
                </div>
                <div class="hex water" style="left: 217px; top: 336px;"><div class="hex-inner"></div></div>
                <div class="hex water" style="left: 265px; top: 336px;">
                    <div class="hex-inner">
                        <div class="harbor-token"><div class="harbor-icon">‚öì</div>3:1</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="legend-mobile">
        <div class="legend-title">üìä Number Guide</div>
        <div class="legend-grid">
            <div class="legend-item">üî¥ 6, 8 = Best</div>
            <div class="legend-item">‚ö´ 5, 9 = Great</div>
            <div class="legend-item">‚ö´ 4, 10 = Good</div>
            <div class="legend-item">‚ö´ 3, 11 = Fair</div>
            <div class="legend-item">‚ö´ 2, 12 = Rare</div>
            <div class="legend-item">üèúÔ∏è Desert = 0</div>
        </div>
    </div>

    <script>
        // Seeded random number generator
        function seededRandom(seed) {
            let x = Math.sin(seed++) * 10000;
            return x - Math.floor(x);
        }

        // Shuffle array with seed
        function shuffleArray(array, seed) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(seededRandom(seed + i) * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // Check if two positions are adjacent
        function areAdjacent(posObj1, posObj2) {
            const pos1 = posObj1.pos || posObj1;
            const pos2 = posObj2.pos || posObj2;
            const [row1, col1] = pos1;
            const [row2, col2] = pos2;

            if (Math.abs(row1 - row2) > 1) return false;

            if (row1 === row2) {
                return Math.abs(col1 - col2) === 1;
            }

            if (row1 % 2 === 0) {
                return col2 === col1 || col2 === col1 - 1;
            } else {
                return col2 === col1 || col2 === col1 + 1;
            }
        }

        // Get pip value for a number
        function getPipValue(num) {
            const pipMap = {2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 8: 5, 9: 4, 10: 3, 11: 2, 12: 1};
            return pipMap[num] || 0;
        }

        // Get all land tile positions (row, col) and mark which are edges
        const landPositions = [
            {pos: [1,0], edge: true}, {pos: [1,1], edge: true}, {pos: [1,2], edge: true},
            {pos: [2,0], edge: true}, {pos: [2,1], edge: false}, {pos: [2,2], edge: false}, {pos: [2,3], edge: true},
            {pos: [3,0], edge: true}, {pos: [3,1], edge: false}, {pos: [3,2], edge: false}, {pos: [3,3], edge: false}, {pos: [3,4], edge: true},
            {pos: [4,0], edge: true}, {pos: [4,1], edge: false}, {pos: [4,2], edge: false}, {pos: [4,3], edge: false}, {pos: [4,4], edge: false}, {pos: [4,5], edge: true},
            {pos: [5,0], edge: true}, {pos: [5,1], edge: false}, {pos: [5,2], edge: false}, {pos: [5,3], edge: false}, {pos: [5,4], edge: true},
            {pos: [6,0], edge: true}, {pos: [6,1], edge: false}, {pos: [6,2], edge: false}, {pos: [6,3], edge: true},
            {pos: [7,0], edge: true}, {pos: [7,1], edge: true}, {pos: [7,2], edge: true}
        ];

        // Harbor positions (water tile indices that can have harbors)
        const harborPositions = [1, 3, 5, 11, 15, 20, 22, 26];

        // Harbor types
        const harbors = [
            {icon: '‚öì', ratio: '3:1', type: 'generic'},
            {icon: '‚öì', ratio: '3:1', type: 'generic'},
            {icon: '‚öì', ratio: '3:1', type: 'generic'},
            {icon: 'üåæ', ratio: '2:1', type: 'wheat'},
            {icon: 'üß±', ratio: '2:1', type: 'brick'},
            {icon: 'üå≤', ratio: '2:1', type: 'wood'},
            {icon: '‚õ∞Ô∏è', ratio: '2:1', type: 'ore'},
            {icon: 'üêë', ratio: '2:1', type: 'sheep'}
        ];

        // Resources
        const resources = [
            'wood', 'wood', 'wood', 'wood', 'wood', 'wood',
            'wheat', 'wheat', 'wheat', 'wheat', 'wheat', 'wheat',
            'sheep', 'sheep', 'sheep', 'sheep', 'sheep', 'sheep',
            'ore', 'ore', 'ore', 'ore', 'ore',
            'brick', 'brick', 'brick', 'brick', 'brick',
            'desert', 'desert'
        ];

        // Number tokens with pip values
        const numbers = [
            {val: 2, letter: 'A', pips: '‚Ä¢', red: false, pipValue: 1},
            {val: 3, letter: 'B', pips: '‚Ä¢‚Ä¢', red: false, pipValue: 2},
            {val: 3, letter: 'C', pips: '‚Ä¢‚Ä¢', red: false, pipValue: 2},
            {val: 4, letter: 'D', pips: '‚Ä¢‚Ä¢‚Ä¢', red: false, pipValue: 3},
            {val: 4, letter: 'E', pips: '‚Ä¢‚Ä¢‚Ä¢', red: false, pipValue: 3},
            {val: 5, letter: 'F', pips: '‚Ä¢‚Ä¢‚Ä¢‚Ä¢', red: false, pipValue: 4},
            {val: 5, letter: 'G', pips: '‚Ä¢‚Ä¢‚Ä¢‚Ä¢', red: false, pipValue: 4},
            {val: 6, letter: 'H', pips: '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢', red: true, pipValue: 5},
            {val: 6, letter: 'I', pips: '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢', red: true, pipValue: 5},
            {val: 8, letter: 'J', pips: '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢', red: true, pipValue: 5},
            {val: 8, letter: 'K', pips: '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢', red: true, pipValue: 5},
            {val: 9, letter: 'L', pips: '‚Ä¢‚Ä¢‚Ä¢‚Ä¢', red: false, pipValue: 4},
            {val: 9, letter: 'M', pips: '‚Ä¢‚Ä¢‚Ä¢‚Ä¢', red: false, pipValue: 4},
            {val: 10, letter: 'N', pips: '‚Ä¢‚Ä¢‚Ä¢', red: false, pipValue: 3},
            {val: 10, letter: 'O', pips: '‚Ä¢‚Ä¢‚Ä¢', red: false, pipValue: 3},
            {val: 11, letter: 'P', pips: '‚Ä¢‚Ä¢', red: false, pipValue: 2},
            {val: 11, letter: 'Q', pips: '‚Ä¢‚Ä¢', red: false, pipValue: 2},
            {val: 12, letter: 'R', pips: '‚Ä¢', red: false, pipValue: 1},
            {val: 2, letter: 'S', pips: '‚Ä¢', red: false, pipValue: 1},
            {val: 3, letter: 'T', pips: '‚Ä¢‚Ä¢', red: false, pipValue: 2},
            {val: 4, letter: 'U', pips: '‚Ä¢‚Ä¢‚Ä¢', red: false, pipValue: 3},
            {val: 5, letter: 'V', pips: '‚Ä¢‚Ä¢‚Ä¢‚Ä¢', red: false, pipValue: 4},
            {val: 6, letter: 'W', pips: '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢', red: true, pipValue: 5},
            {val: 8, letter: 'X', pips: '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢', red: true, pipValue: 5},
            {val: 9, letter: 'Y', pips: '‚Ä¢‚Ä¢‚Ä¢‚Ä¢', red: false, pipValue: 4},
            {val: 10, letter: 'Za', pips: '‚Ä¢‚Ä¢‚Ä¢', red: false, pipValue: 3},
            {val: 11, letter: 'Zb', pips: '‚Ä¢‚Ä¢', red: false, pipValue: 2},
            {val: 12, letter: 'Zc', pips: '‚Ä¢', red: false, pipValue: 1}
        ];

        const resourceLabels = {
            wood: 'Wood',
            wheat: 'Wheat',
            sheep: 'Sheep',
            ore: 'Ore',
            brick: 'Brick',
            desert: 'Desert'
        };

        // Check if number placement is balanced
        function isBalancedPlacement(shuffledNumbers, shuffledResources, nonDesertIndices) {
            // Check 1: No adjacent red numbers (6, 8)
            for (let i = 0; i < nonDesertIndices.length; i++) {
                const idx1 = nonDesertIndices[i];
                const num1 = shuffledNumbers[i];

                if (!num1 || !num1.red) continue;

                for (let j = i + 1; j < nonDesertIndices.length; j++) {
                    const idx2 = nonDesertIndices[j];
                    const num2 = shuffledNumbers[j];

                    if (!num2) continue;

                    if (num2.red && areAdjacent(landPositions[idx1], landPositions[idx2])) {
                        return false;
                    }
                }
            }

            // Check 2: No clusters of high-pip numbers (prevent 3+ adjacent high-value tiles)
            for (let i = 0; i < nonDesertIndices.length; i++) {
                const idx1 = nonDesertIndices[i];
                const num1 = shuffledNumbers[i];

                if (!num1 || num1.pipValue < 4) continue;

                let highPipNeighbors = 0;
                for (let j = 0; j < nonDesertIndices.length; j++) {
                    if (i === j) continue;
                    const idx2 = nonDesertIndices[j];
                    const num2 = shuffledNumbers[j];

                    if (num2 && num2.pipValue >= 4 && areAdjacent(landPositions[idx1], landPositions[idx2])) {
                        highPipNeighbors++;
                    }
                }

                if (highPipNeighbors >= 3) {
                    return false;
                }
            }

            return true;
        }

        function shuffleBoard() {
            const seedInput = document.getElementById('seedInput').value;
            const seed = seedInput ? parseInt(seedInput) || seedInput.split('').reduce((a, b) => a + b.charCodeAt(0), 0) : Date.now();

            // Shuffle resources
            const edgeIndices = landPositions.map((p, i) => p.edge ? i : -1).filter(i => i >= 0);
            const nonEdgeIndices = landPositions.map((p, i) => !p.edge ? i : -1).filter(i => i >= 0);

            let shuffledResources = new Array(30);
            const nonDesertResources = resources.filter(r => r !== 'desert');

            const shuffledEdges = shuffleArray(edgeIndices, seed);
            const desertPos1 = shuffledEdges[0];
            const desertPos2 = shuffledEdges[1];
            shuffledResources[desertPos1] = 'desert';
            shuffledResources[desertPos2] = 'desert';

            const remainingIndices = [];
            for (let i = 0; i < 30; i++) {
                if (i !== desertPos1 && i !== desertPos2) {
                    remainingIndices.push(i);
                }
            }

            const shuffledNonDesert = shuffleArray(nonDesertResources, seed + 500);
            remainingIndices.forEach((idx, i) => {
                shuffledResources[idx] = shuffledNonDesert[i];
            });

            // Shuffle numbers with better balancing
            let shuffledNumbers = shuffleArray(numbers, seed + 1000);
            const nonDesertIndices = shuffledResources.map((r, i) => r !== 'desert' ? i : -1).filter(i => i >= 0);

            let attempts = 0;
            while (attempts < 200 && !isBalancedPlacement(shuffledNumbers, shuffledResources, nonDesertIndices)) {
                shuffledNumbers = shuffleArray(numbers, seed + 1000 + attempts);
                attempts++;
            }

            // Shuffle harbors
            const shuffledHarbors = shuffleArray(harbors, seed + 2000);
            const shuffledHarborPositions = shuffleArray(harborPositions, seed + 3000);

            // Update land hexes
            const hexes = document.querySelectorAll('.hex:not(.water)');
            let numberIndex = 0;

            hexes.forEach((hex, index) => {
                const resource = shuffledResources[index];
                hex.className = 'hex ' + resource;

                const inner = hex.querySelector('.hex-inner');
                const label = resourceLabels[resource];

                if (resource === 'desert') {
                    inner.innerHTML = `
                        <div class="resource-label">${label}</div>
                        <div class="number-token" style="background: transparent; border: none; box-shadow: none;">
                            <div style="font-size: 16px;">üèúÔ∏è</div>
                        </div>
                    `;
                } else {
                    const num = shuffledNumbers[numberIndex++];
                    if (!num) {
                        inner.innerHTML = `
                            <div class="resource-label">${label}</div>
                            <div class="number-token">
                                <div class="number black">?</div>
                            </div>
                        `;
                    } else {
                        const colorClass = num.red ? 'red' : 'black';
                        inner.innerHTML = `
                            <div class="resource-label">${label}</div>
                            <div class="number-token">
                                <div class="number ${colorClass}">${num.val}</div>
                                <div class="token-letter">${num.letter}</div>
                                <div class="pips">${num.pips}</div>
                            </div>
                        `;
                    }
                }
            });

            // Update water hexes with randomized harbors
            const waterHexes = document.querySelectorAll('.hex.water');
            waterHexes.forEach((hex, index) => {
                const inner = hex.querySelector('.hex-inner');

                // Check if this water hex should have a harbor
                const harborIndex = shuffledHarborPositions.indexOf(index);
                if (harborIndex !== -1 && harborIndex < shuffledHarbors.length) {
                    const harbor = shuffledHarbors[harborIndex];
                    inner.innerHTML = `
                        <div class="harbor-token"><div class="harbor-icon">${harbor.icon}</div>${harbor.ratio}</div>
                    `;
                } else {
                    inner.innerHTML = '';
                }
            });
        }
    </script>
</body>
</html>
